<template>
<div class="overflow-hidden">
        <div class="container pt-12 pt-lg-7 pb-14 pb-md-16">
          <div class="row">
            <div class="col-lg-10 col-xl-9 col-xxl-8 mx-auto text-center">
              <h2 class="fs-16 text-uppercase text-primary mb-3">Latest Projects</h2>
              <h3 class="display-3 mb-10">Check out some of our awesome projects with creative ideas and great design.</h3>
            </div>
            <!-- /column -->
          </div>
          <!-- /.row -->
          <div class="swiper-container grid-view nav-bottom nav-color mb-14 swiper-container-0" data-margin="30" data-dots="false" data-nav="true" data-items-md="2" data-items-xs="1">
            <div class="swiper overflow-visible swiper-initialized swiper-horizontal swiper-backface-hidden">
              <div class="swiper-wrapper" style="cursor: grab; transform: translate3d(0px, 0px, 0px);" id="swiper-wrapper-a7819bc2893d2de6" aria-live="off">
                <div class="swiper-slide swiper-slide-active" style="width: 450px; margin-right: 30px;" role="group" aria-label="1 / 6">
                  <figure class="rounded mb-7"><a href="./single-project.html"><img src="../assets/img/photos/sp1.jpg" srcset="../assets/img/photos/sp1@2x.jpg 2x" alt=""></a></figure>
                  <div class="project-details d-flex justify-content-center flex-column">
                    <div class="post-header">
                      <h2 class="post-title h3"><a href="./single-project.html" class="link-dark">Cras Fermentum Sem</a></h2>
                      <div class="post-category text-ash">Mobile Design</div>
                    </div>
                    <!-- /.post-header -->
                  </div>
                  <!-- /.project-details -->
                </div>
                <!--/.swiper-slide -->
                <div class="swiper-slide swiper-slide-next" style="width: 450px; margin-right: 30px;" role="group" aria-label="2 / 6">
                  <figure class="rounded mb-7"><a href="./single-project.html"><img src="../assets/img/photos/sp2.jpg" srcset="../assets/img/photos/sp2@2x.jpg 2x" alt=""></a></figure>
                  <div class="project-details d-flex justify-content-center flex-column">
                    <div class="post-header">
                      <h2 class="post-title h3"><a href="./single-project.html" class="link-dark">Venenatis Euismod Vehicula</a></h2>
                      <div class="post-category text-ash">Web Design</div>
                    </div>
                    <!-- /.post-header -->
                  </div>
                  <!-- /.project-details -->
                </div>
                <!--/.swiper-slide -->
                <div class="swiper-slide" style="width: 450px; margin-right: 30px;" role="group" aria-label="3 / 6">
                  <figure class="rounded mb-7"><a href="./single-project.html"><img src="../assets/img/photos/sp3.jpg" srcset="../assets/img/photos/sp3@2x.jpg 2x" alt=""></a></figure>
                  <div class="project-details d-flex justify-content-center flex-column">
                    <div class="post-header">
                      <h2 class="post-title h3"><a href="./single-project.html" class="link-dark">Tortor Tellus Cursus</a></h2>
                      <div class="post-category text-ash">Stationary</div>
                    </div>
                    <!-- /.post-header -->
                  </div>
                  <!-- /.project-details -->
                </div>
                <!--/.swiper-slide -->
                <div class="swiper-slide" style="width: 450px; margin-right: 30px;" role="group" aria-label="4 / 6">
                  <figure class="rounded mb-7"><a href="./single-project.html"><img src="../assets/img/photos/sp4.jpg" srcset="../assets/img/photos/sp4@2x.jpg 2x" alt=""></a></figure>
                  <div class="project-details d-flex justify-content-center flex-column">
                    <div class="post-header">
                      <h2 class="post-title h3"><a href="./single-project.html" class="link-dark">Ridiculus Sem Parturient</a></h2>
                      <div class="post-category text-ash">Web Application</div>
                    </div>
                    <!-- /.post-header -->
                  </div>
                  <!-- /.project-details -->
                </div>
                <!--/.swiper-slide -->
                <div class="swiper-slide" style="width: 450px; margin-right: 30px;" role="group" aria-label="5 / 6">
                  <figure class="rounded mb-7"><a href="./single-project.html"><img src="../assets/img/photos/sp5.jpg" srcset="../assets/img/photos/sp5@2x.jpg 2x" alt=""></a></figure>
                  <div class="project-details d-flex justify-content-center flex-column">
                    <div class="post-header">
                      <h2 class="post-title h3"><a href="./single-project.html" class="link-dark">Cursus Sollicitudin Adipiscing</a></h2>
                      <div class="post-category text-ash">Web Design</div>
                    </div>
                    <!-- /.post-header -->
                  </div>
                  <!-- /.project-details -->
                </div>
                <!--/.swiper-slide -->
                <div class="swiper-slide" role="group" aria-label="6 / 6" style="width: 450px; margin-right: 30px;">
                  <figure class="rounded mb-7"><a href="./single-project.html"><img src="../assets/img/photos/sp6.jpg" srcset="../assets/img/photos/sp6@2x.jpg 2x" alt=""></a></figure>
                  <div class="project-details d-flex justify-content-center flex-column">
                    <div class="post-header">
                      <h2 class="post-title h3"><a href="./single-project.html" class="link-dark">Fringilla Quam Vulputate</a></h2>
                      <div class="post-category text-ash">Stationary</div>
                    </div>
                    <!-- /.post-header -->
                  </div>
                  <!-- /.project-details -->
                </div>
                <!--/.swiper-slide -->
              </div>
              <!--/.swiper-wrapper -->
            <span class="swiper-notification" aria-live="assertive" aria-atomic="true"></span></div>
            <!-- /.swiper -->
          </div></div>
          <!-- /.swiper-container -->
        </div>
        <!-- /.container -->
        <div class="divider text-soft-primary mx-n2">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 100">
            <path fill="currentColor" d="M1260,1.65c-60-5.07-119.82,2.47-179.83,10.13s-120,11.48-180,9.57-120-7.66-180-6.42c-60,1.63-120,11.21-180,16a1129.52,1129.52,0,0,1-180,0c-60-4.78-120-14.36-180-19.14S60,7,30,7H0v93H1440V30.89C1380.07,23.2,1319.93,6.15,1260,1.65Z"></path>
          </svg>
        </div>
      <!-- /.overflow-hidden -->
</template>
<script setup>
import { onMounted, onBeforeUnmount, nextTick } from 'vue'

let destroy = () => {}

onMounted(async () => {
  try {
    if (typeof window === 'undefined') return
    await nextTick()
    const { default: Swiper } = await import('swiper/bundle')

    const hosts = document.querySelectorAll('.swiper-container')
    const instances = []

    hosts.forEach((host, idx) => {
      // prepare controls only if needed and not already present
      const wantDots = host.getAttribute('data-dots') === 'true'
      const wantNav  = host.getAttribute('data-nav') === 'true'

      let controls = host.querySelector('.swiper-controls')
      if (!controls && (wantDots || wantNav)) {
        controls = document.createElement('div')
        controls.className = 'swiper-controls'
        host.appendChild(controls)
      }

      let pagi = host.querySelector('.swiper-pagination')
      if (wantDots && !pagi && controls) {
        pagi = document.createElement('div')
        pagi.className = 'swiper-pagination'
        controls.appendChild(pagi)
      }

      let navi = host.querySelector('.swiper-navigation')
      let prev = host.querySelector('.swiper-button-prev')
      let next = host.querySelector('.swiper-button-next')
      if (wantNav && !navi && controls) {
        navi = document.createElement('div'); navi.className = 'swiper-navigation'
        prev = document.createElement('div'); prev.className = 'swiper-button swiper-button-prev'
        next = document.createElement('div'); next.className = 'swiper-button swiper-button-next'
        controls.appendChild(navi); navi.appendChild(prev); navi.appendChild(next)
      }

      const swiperEl = host.querySelector('.swiper:not(.swiper-thumbs)')
      if (!swiperEl) return

      let inst
      // reuse if already initialized
      if (swiperEl.classList.contains('swiper-initialized') && swiperEl.swiper) {
        inst = swiperEl.swiper
      } else {
        const num = (a, d) => Number(host.getAttribute(a) || d)
        const itemsAuto    = host.getAttribute('data-items-auto') === 'true'
        const speed        = num('data-speed', 500)
        const autoplay     = host.getAttribute('data-autoplay') !== 'false'
        const autoplayTime = num('data-autoplaytime', 5000)
        const allowTouch   = host.getAttribute('data-drag') !== 'false'
        const reverse      = host.getAttribute('data-reverse') === 'true'
        const margin       = num('data-margin', 30)
        const loop         = host.getAttribute('data-loop') === 'true'
        const centered     = host.getAttribute('data-centered') === 'true'
        const autoHeight   = host.getAttribute('data-autoheight') === 'true'
        const resizeUpdate = host.getAttribute('data-resizeupdate') !== 'false'
        const effect       = host.getAttribute('data-effect') || 'slide'

        let slidesPerViewInit, breakpointsInit = null
        if (itemsAuto) {
          slidesPerViewInit = 'auto'
        } else {
          const xs  = num('data-items-xs', 1)
          const sm  = num('data-items-sm', xs)
          const md  = num('data-items-md', sm)
          const lg  = num('data-items-lg', md)
          const xl  = num('data-items-xl', lg)
          const xxl = num('data-items-xxl', xl)
          slidesPerViewInit = num('data-items', 3)
          breakpointsInit = { 0:{slidesPerView:xs}, 576:{slidesPerView:sm}, 768:{slidesPerView:md}, 992:{slidesPerView:lg}, 1200:{slidesPerView:xl}, 1400:{slidesPerView:xxl} }
        }

        inst = new Swiper(swiperEl, {
          autoplay: autoplay ? { delay: autoplayTime, disableOnInteraction: false, reverseDirection: reverse, pauseOnMouseEnter: false } : false,
          allowTouchMove: allowTouch,
          speed,
          slidesPerView: slidesPerViewInit,
          loop,
          centeredSlides: centered,
          spaceBetween: margin,
          effect,
          autoHeight,
          watchOverflow: false,
          grabCursor: true,
          resizeObserver: false,
          updateOnWindowResize: resizeUpdate,
          breakpoints: breakpointsInit || undefined,
          pagination: { el: pagi || null, clickable: true, enabled: !!pagi },
          navigation: { prevEl: prev || null, nextEl: next || null, enabled: !!(prev && next) },
        })
      }

      if (prev && next) {
        prev.addEventListener('click', () => { try { inst.slidePrev() } catch (e) {} })
        next.addEventListener('click', () => { try { inst.slideNext() } catch (e) {} })
      }

      instances.push(inst)
    })

    destroy = () => instances.forEach(i => { try { i.destroy(true, true) } catch (e) {} })
  } catch (err) {
    console.error('[Companyfacts] initSwipers error:', err)
  }
})

onBeforeUnmount(() => destroy())
</script>



<style scoped>
.swiper-controls { pointer-events: auto; }
.swiper-navigation { position: relative; pointer-events: auto; }
.swiper-button {
  position: absolute; top: 50%; transform: translateY(-50%);
  z-index: 50; width: 44px; height: 44px; cursor: pointer;
  pointer-events: auto;
}

.swiper-button-prev { left: 8px; }
.swiper-button-next { right: 8px; }

.swiper-controls { pointer-events: auto; display: flex; justify-content: center; margin-top: 14px; }
.swiper-navigation { position: relative; pointer-events: auto; display: flex; gap: 12px; }
.swiper-button {
  width: 44px; height: 44px; border-radius: 9999px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 2px 10px rgba(0,0,0,.08); background: rgba(0,0,0,.04);
  z-index: 50; pointer-events: auto;
}

.swiper-button-prev::after { content: '←'; font-size: 18px; line-height: 1; }
.swiper-button-next::after { content: '→'; font-size: 18px; line-height: 1; }


.swiper-controls { pointer-events: auto; display: flex; justify-content: center; margin-top: 14px; }
.swiper-navigation { position: relative; pointer-events: auto; display: flex; gap: 12px; }
.swiper-button {
  width: 44px; height: 44px; border-radius: 9999px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 2px 10px rgba(0,0,0,.08); background: rgba(0,0,0,.04);
  z-index: 50; pointer-events: auto;
}
.swiper-button-prev::after { content: '←'; font-size: 18px; line-height: 1; }
.swiper-button-next::after { content: '→'; font-size: 18px; line-height: 1; }

</style>